# Project: Command Injection (CVE-2021-44228 Explained)

![Project Image](https://securityidiots.com/post_images/addslashes.png)

## Description



At the end of this project, you are expected to be able toexplain to anyone,without the help of Google:

## Resources

#### Read or watch:

* [Command Injection](/rltoken/FWGVceVblafyq0T6PLmDNw)
* [Command Injection Overiew](/rltoken/dAAxMTZf8uKf_JHAGxIVsw)
* [BashGuide](/rltoken/jO1u-98qwjP4WXR5__0rqQ)
* [Playload For Command Injection](/rltoken/f-cm8EsLjI6Nv-jHay3cYA)
* [Bash Special Variables](/rltoken/0ZSyAvd0BzRFnbE59tgXnQ)
* [Difference Between Executing Multiple Commands with && and ;](/rltoken/7SgA5XePTeZIpLxoN2blRQ)
* [The Meaning of IFS in Bash Scripting](/rltoken/4VZ2zG87loJ0utvCbOblXA)
* [Hackers Triks](/rltoken/a50NZ5LxEoQpVQif5QFvGA)
* [How To Prevent Command Injection Vulnerability?](/rltoken/CBLHFGVXdO8Mhfzbwmq_6w)

#### References:

* [command injection](/rltoken/FWGVceVblafyq0T6PLmDNw)

#### If you don‚Äôt have Burp Suite pro version you can use interactsh docker image to create a client that will receive the request:

* [interactsh](/rltoken/ef2PENHJ39GBQ8WheCV2GA)


## Learning Objectives

* What is command injection?
* How does command injection work?
* What are the common payloads used for command injection?
* What are some of the most common attack vectors for command injection?
* What are Bash special variables and how are they used?
* What is the difference between executing multiple commands with&&and;in Bash?
* What doesIFS(Internal Field Separator) mean in Bash scripting?
* How can you manipulateIFSto affect command execution?
* What are some common tricks hackers use to exploit command injection vulnerabilities?
* What are the potential impacts of a successful command injection attack on a system?
* What steps can you take to secure your web applications against command injection?


## Requirements

### General

* Allowed editors:vi,vim,emacs.
* All your scripts will be tested onKali Linux.
* All your scripts should be exactly two lines long ($ wc -l fileshould print 2)
* You must substitute the IP range for$1.
* All your files should end with a new line (Why?)
* AREADME.mdfile, at the root of the folder of the project, is mandatory


## Tasks

### 0. Let's see if our ping tool sings‚Äîinject some fun and find hidden commands!



Insecure applications can be tricked into running harmful commands, giving attackers control of the system. This happens when user input isn‚Äôt checked properly.
To prevent this, applications need to thoroughly examine all inputs and use secure coding techniques.

Challenge

We‚Äôre building our Asset Discovery tool and integrating some new features. Before we release it, we need thorough 
testing. Can you help us ensure it‚Äôs secure?

This challenge revolves around the Command Injection vulnerability. Thepinginput is vulnerable.
Your mission begins with identifying and exploiting the command injection vulnerability in thepingfunctionality.

* Target Application:  cyberwebsec0x09task0
* Initial Endpoint:http://web0x09.hbtn-task0/

```bash
Useful instructions:
1. Log into Asset Discovery tool.
2. ping is vulnerable.
3. We can try and give it an input (google.com for example).
4. Flag Location `/0-flag.txt`
```

**Repo Info:**
* GitHub repository:holbertonschool-cyber_security
* Directory:web_application_security/0x09_command_injection
* File:0-flag.txt

### 1. Inject fun, reveal hidden secrets!



Welcome back to the next phase of your journey through the world of Command Injection vulnerabilities, set against the backdrop of our enhanced 
Asset Discovery tool.

Your mission now is to test the improved security measures and exploit the command injection vulnerability in thepingfunctionality.

Challenge

We‚Äôre building our Asset Discovery tool and integrating some new features. We‚Äôve added a security layer, and we think it‚Äôs more secure now. 
Can you test it and ensure it‚Äôs safe?

This challenge focuses on Command Injection. Thepinginput is still vulnerable, but with some added security measures.

* Target Application: cyberwebsec0x09task1
* Initial Endpoint:http://web0x09.hbtn-task1

```bash
Useful instructions:
1. Log into Asset Discovery tool.
2. ping is vulnerable.
3. We can try and give it an input (google.com for example).
4. To exploit this vulnerability, we need to use Bypass space, Bypass command check.
5. Flag Location is `/etc/1-flag.txt`
```

**Repo Info:**
* GitHub repository:holbertonschool-cyber_security
* Directory:web_application_security/0x09_command_injection
* File:1-flag.txt

### 2. Hack, laugh, uncover, win!



Here‚Äôs another step in our cyber adventure! Let‚Äôs move forward and dive into the challenge ahead.

Despite our efforts, vulnerabilities may still lurk. Your mission? To test the tool‚Äôs defenses, exploit its weaknesses, and uncover hidden flags.

Challenge

This challenge involves a tool that pings given hosts. The goal is to exploit a command injection vulnerability in the user-supplied domain. However, the application has blacklisted many commands and special characters, including spaces and slashes. To bypass the filter, you‚Äôll need to construct the path for the flag using theHOMEenvironment variable.

* Target Application:cyber_websec_0x09_task_2
* Initial Endpoint:http://web0x09.hbtn-task2

```bash
Useful instructions:
1. Log into Asset Discovery tool.
2. ping is vulnerable.
3. We can try and give it an input (google.com for example).
4. To exploit this vulnerability, we need to use Bypass space, Bypass command check.
5. The flag is in /var/2-flag.txt
6. Path crafted with HOME bypasses filter.
7. Player supplied with source code.
```

**Repo Info:**
* GitHub repository:holbertonschool-cyber_security
* Directory:web_application_security/0x09_command_injection
* File:2-flag.txt

### 3. Admins wary. Flag hunt on!



After previous exploits, trust is scarce. Only trusted admins will receive scan results. Can you still find the flag?

Even with our best efforts, vulnerabilities linger. Your challenge? Probe the tool‚Äôs defenses, exploit its flaws, and unveil hidden flags.

Challenge

This challenge uses a tool to ping specified hosts, aiming to exploit a command injection vulnerability in the user-supplied domain. Since the application does not provide an output, you need to use thenslookupcommand to send the flag file‚Äôs content to Burp Collaborator.

* Target Application:Asset Discovery tool
* Initial Endpoint:http://web0x09.hbtn/app4/

```bash
Useful instructions:
1. Log into Asset Discovery tool.
2. ping is vulnerable.
3. We can try and give it an input (google.com for example).
4. Use the nslookup command 
5. Flag Location "/var/www/3-flag.txt"
```

**Repo Info:**
* GitHub repository:holbertonschool-cyber_security
* Directory:web_application_security/0x09_command_injection
* File:3-flag.txt

### 4. Map vulnerabilities, find hidden flags!



Welcome to the next level of your cybersecurity adventure! We‚Äôre taking our Asset Discovery tool up a notch by integrating nmap for open port checks. But have we secured it enough

Nmap Time! Ready for a New Challenge? üïµÔ∏è‚Äç

This challenge focuses on exploiting a command injection vulnerability within the nmap input.

You can work with thisScript

* Target Application:Asset Discovery tool
* Initial Endpoint:http://web0x09.hbtn/app5/

```bash
Useful instructions:
1. Log into Asset Discovery tool.
2. The nmap input is vulnerable.
3. We can try and give it an input (127.0.0.1:3000 for example).
4. Flag Location /bin/4-flag.txt
```

**Repo Info:**
* GitHub repository:holbertonschool-cyber_security
* Directory:web_application_security/0x09_command_injection
* File:4-flag.txt

### Tasks list

* Mandatory
* Advanced


